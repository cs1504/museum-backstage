{extend name='common@base'/}

{block name='title'}博物馆管理{/block}

{block name='breadcrumb'}
<ul class="breadcrumb">
    <li>
        <i class="ace-icon fa fa-list-alt home-icon"></i>
        <a href="/news">新闻管理</a>
    </li>

    <li>
        <a href="/news">添加新闻</a>
    </li>
</ul><!-- /.breadcrumb -->
{/block}


{block name='content'}

<div class="page-header">
    <h1>
        添加新闻
    </h1>
</div><!-- /.page-header -->

<div class="row">
    <div class="col-sm-12">
        <form class="form-horizontal style-form" action="/news/insert" method="post">
            <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">文章标题</label>
                <div class="col-sm-9">
                    <input name="title" type="text" class="form-control" required="required">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">文章作者</label>
                <div class="col-sm-9">
                    <input name="author" type="text" class="form-control" required="required">
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">摘要</label>
                <div class="col-sm-9">
                    <textarea name="excerpt" class="autosize-transition form-control" rows="3" required="required"></textarea>
                </div>
            </div>
            <div class="form-group">
                <label class="col-sm-2 col-sm-2 control-label">文章内容</label>

                <div class="col-sm-9 widget-box widget-color-blue">
                    <div class="widget-header widget-header-small">  </div>

                    <div class="widget-body">
                        <div class="widget-main no-padding">
                            <textarea name="content" data-provide="markdown" data-iconlibrary="fa" class="autosize-transition" rows="10">文章
                            </textarea>
                        </div>

                        <div class="widget-toolbox padding-4 clearfix">
                            <div class="btn-group pull-left">
                                <button class="btn btn-sm btn-info">
                                    <i class="ace-icon fa fa-times bigger-125"></i>
                                    Cancel
                                </button>
                            </div>

                            <div class="btn-group pull-right">
                                <button class="btn btn-sm btn-purple">
                                    <i class="ace-icon fa fa-floppy-o bigger-125"></i>
                                    Save
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <div class="col-sm-2"></div>
                <div class="col-sm-9">
                    <button type="submit" class="btn btn-info no-border center">提交</button>
                </div>
            </div>
        </form>
    </div>
</div>





{/block}

{block name='script'}

<!-- page specific plugin scripts -->
<script src="__STATIC__/assets/js/jquery-ui.custom.js"></script>
<script src="__STATIC__/assets/js/jquery.ui.touch-punch.js"></script>
<script src="__STATIC__/assets/js/markdown/markdown.js"></script>
<script src="__STATIC__/assets/js/markdown/bootstrap-markdown.js"></script>
<script src="__STATIC__/assets/js/jquery.hotkeys.js"></script>
<script src="__STATIC__/assets/js/bootstrap-wysiwyg.js"></script>
<script src="__STATIC__/assets/js/bootbox.js"></script>

<!-- ace scripts -->
<script src="__STATIC__/assets/js/ace/elements.scroller.js"></script>
<script src="__STATIC__/assets/js/ace/elements.colorpicker.js"></script>
<script src="__STATIC__/assets/js/ace/elements.fileinput.js"></script>
<script src="__STATIC__/assets/js/ace/elements.typeahead.js"></script>
<script src="__STATIC__/assets/js/ace/elements.wysiwyg.js"></script>
<script src="__STATIC__/assets/js/ace/elements.spinner.js"></script>
<script src="__STATIC__/assets/js/ace/elements.treeview.js"></script>
<script src="__STATIC__/assets/js/ace/elements.wizard.js"></script>
<script src="__STATIC__/assets/js/ace/elements.aside.js"></script>
<script src="__STATIC__/assets/js/ace/ace.js"></script>
<script src="__STATIC__/assets/js/ace/ace.ajax-content.js"></script>
<script src="__STATIC__/assets/js/ace/ace.touch-drag.js"></script>
<script src="__STATIC__/assets/js/ace/ace.sidebar.js"></script>
<script src="__STATIC__/assets/js/ace/ace.sidebar-scroll-1.js"></script>
<script src="__STATIC__/assets/js/ace/ace.submenu-hover.js"></script>
<script src="__STATIC__/assets/js/ace/ace.widget-box.js"></script>
<script src="__STATIC__/assets/js/ace/ace.settings.js"></script>
<script src="__STATIC__/assets/js/ace/ace.settings-rtl.js"></script>
<script src="__STATIC__/assets/js/ace/ace.settings-skin.js"></script>
<script src="__STATIC__/assets/js/ace/ace.widget-on-reload.js"></script>
<script src="__STATIC__/assets/js/ace/ace.searchbox-autocomplete.js"></script>


<!-- inline scripts related to this page -->
<script type="text/javascript">
    jQuery(function($){

        function showErrorAlert (reason, detail) {
            var msg='';
            if (reason==='unsupported-file-type') { msg = "Unsupported format " +detail; }
            else {
                //console.log("error uploading file", reason, detail);
            }
            $('<div class="alert"> <button type="button" class="close" data-dismiss="alert">&times;</button>'+
                '<strong>File upload error</strong> '+msg+' </div>').prependTo('#alerts');
        }



        $('[data-toggle="buttons"] .btn').on('click', function(e){
            var target = $(this).find('input[type=radio]');
            var which = parseInt(target.val());
            var toolbar = $('#editor1').prev().get(0);
            if(which >= 1 && which <= 4) {
                toolbar.className = toolbar.className.replace(/wysiwyg\-style(1|2)/g , '');
                if(which == 1) $(toolbar).addClass('wysiwyg-style1');
                else if(which == 2) $(toolbar).addClass('wysiwyg-style2');
                if(which == 4) {
                    $(toolbar).find('.btn-group > .btn').addClass('btn-white btn-round');
                } else $(toolbar).find('.btn-group > .btn-white').removeClass('btn-white btn-round');
            }
        });




        //RESIZE IMAGE

        //Add Image Resize Functionality to Chrome and Safari
        //webkit browsers don't have image resize functionality when content is editable
        //so let's add something using jQuery UI resizable
        //another option would be opening a dialog for user to enter dimensions.
        if ( typeof jQuery.ui !== 'undefined' && ace.vars['webkit'] ) {

            var lastResizableImg = null;
            function destroyResizable() {
                if(lastResizableImg == null) return;
                lastResizableImg.resizable( "destroy" );
                lastResizableImg.removeData('resizable');
                lastResizableImg = null;
            }

            var enableImageResize = function() {
                $('.wysiwyg-editor')
                    .on('mousedown', function(e) {
                        var target = $(e.target);
                        if( e.target instanceof HTMLImageElement ) {
                            if( !target.data('resizable') ) {
                                target.resizable({
                                    aspectRatio: e.target.width / e.target.height,
                                });
                                target.data('resizable', true);

                                if( lastResizableImg != null ) {
                                    //disable previous resizable image
                                    lastResizableImg.resizable( "destroy" );
                                    lastResizableImg.removeData('resizable');
                                }
                                lastResizableImg = target;
                            }
                        }
                    })
                    .on('click', function(e) {
                        if( lastResizableImg != null && !(e.target instanceof HTMLImageElement) ) {
                            destroyResizable();
                        }
                    })
                    .on('keydown', function() {
                        destroyResizable();
                    });
            }

            enableImageResize();

        }


    });
</script>
<script src="__STATIC__/assets/js/jquery.autosize.js"></script>
<script src="__STATIC__/assets/js/jquery.inputlimiter.1.3.1.js"></script>

<!-- inline scripts related to this page -->
<script type="text/javascript">
    jQuery(function($) {
        $('textarea[class*=autosize]').autosize({append: "\n", max: "30"});
        $('textarea.limited').inputlimiter({
            remText: '%n character%s remaining...',
            limitText: 'max allowed : %n.'
        });
    });
</script>

<style>
    textarea{
        max-height: 600px;
    }
</style>
{/block}